%s = complex([0         0    0.3536    0.3536    0.3536    0.3536    0.3536    0.6124]');

s = complex([0.3536 0.3536 0.3536 0.3536 0.3536 0.3536 0.3536 0.3536]');

sfull = zeros(2^7,1);
sfull(bin2dec('0001001')+1) = s(1);
sfull(bin2dec('0010010')+1) = s(2);
sfull(bin2dec('0011011')+1) = s(3);
sfull(bin2dec('0101101')+1) = s(4);
sfull(bin2dec('0110110')+1) = s(5);
sfull(bin2dec('0111000')+1) = s(6);
sfull(bin2dec('0111100')+1) = s(7);
sfull(bin2dec('0111111')+1) = s(8);

U1 = [ 
-0.0000 + 1.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i
0.0000 + 0.0000i  -0.0000 - 1.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i
0.0000 + 0.0000i   0.0000 + 0.0000i  -0.0000 + 1.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i
0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.0000 - 1.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i
0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.0000 + 1.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i
0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.0000 - 1.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i
0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.0000 + 1.0000i   0.0000 + 0.0000i
0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i   0.0000 + 0.0000i  -0.0000 - 1.0000i
];
	
sfullU1 = kron(eye(2),kron(U1,eye(8))) * sfull;
%for i = 1:size(sfullU1,1)
%	if abs(sfullU1(i)) > 0.0000001
%		sfullU1(i)
%		abs(sfullU1(i)).^2
%		dec2bin(i-1,7)
%	end
%end

U2 = [
0.6414    0.7672         0         0         0         0         0         0
-0.7672    0.6414         0         0         0         0         0         0
0         0    0.6414    0.7672         0         0         0         0
0         0   -0.7672    0.6414         0         0         0         0
0         0         0         0    0.6414    0.7672         0         0
0         0         0         0   -0.7672    0.6414         0         0
0         0         0         0         0         0    0.6414    0.7672
0         0         0         0         0         0   -0.7672    0.6414
];

sfullnxt = kron(eye(2),kron(U2,eye(8))) * sfullU1;
%for i = 1:size(sfullnxt,1)
%	if abs(sfullnxt(i)) > 0.0000001
%		sfullnxt(i)
%		abs(sfullnxt(i)).^2
%		dec2bin(i-1,7)
%	end
%end

BOqx = [														
-0.1444 - 0.0598i   0.4501 + 0.1864i   0.4501 + 0.1864i   0.2598 + 0.1076i   0.4501 + 0.1864i   0.2598 + 0.1076i   0.2598 + 0.1076i   0.1500 + 0.0621i
0.4501 + 0.1864i  -0.6640 - 0.2751i   0.2598 + 0.1076i   0.1500 + 0.0621i   0.2598 + 0.1076i   0.1500 + 0.0621i   0.1500 + 0.0621i   0.0866 + 0.0359i
0.4501 + 0.1864i   0.2598 + 0.1076i  -0.6640 - 0.2751i   0.1500 + 0.0621i   0.2598 + 0.1076i   0.1500 + 0.0621i   0.1500 + 0.0621i   0.0866 + 0.0359i
0.2598 + 0.1076i   0.1500 + 0.0621i   0.1500 + 0.0621i  -0.8373 - 0.3468i   0.1500 + 0.0621i   0.0866 + 0.0359i   0.0866 + 0.0359i   0.0500 + 0.0207i
0.4501 + 0.1864i   0.2598 + 0.1076i   0.2598 + 0.1076i   0.1500 + 0.0621i  -0.6640 - 0.2751i   0.1500 + 0.0621i   0.1500 + 0.0621i   0.0866 + 0.0359i
0.2598 + 0.1076i   0.1500 + 0.0621i   0.1500 + 0.0621i   0.0866 + 0.0359i   0.1500 + 0.0621i  -0.8373 - 0.3468i   0.0866 + 0.0359i   0.0500 + 0.0207i
0.2598 + 0.1076i   0.1500 + 0.0621i   0.1500 + 0.0621i   0.0866 + 0.0359i   0.1500 + 0.0621i   0.0866 + 0.0359i  -0.8373 - 0.3468i   0.0500 + 0.0207i
0.1500 + 0.0621i   0.0866 + 0.0359i   0.0866 + 0.0359i   0.0500 + 0.0207i   0.0866 + 0.0359i   0.0500 + 0.0207i   0.0500 + 0.0207i   -0.8950 - 0.3707i
];

sfullBO = kron(eye(2),kron(BOqx,eye(8))) * sfull;
for i = 1:size(sfullBO,1)
	if abs(sfullBO(i)) > 0.0000001
		sfullBO(i)
%		abs(sfullBO(i)).^2
		dec2bin(i-1,7)
	end
end

